---
import Layout from '../layouts/Layout.astro';
import MobileCTA from '../components/MobileCTA.astro';
import Contact from '../components/Contact.astro';
import { data } from '../data/siteData';

const title = `Épaviste à Toulouse — enlèvement d’épaves gratuit (100 km) | ${data.name}`;
const description = "Épaviste agréé VHU : enlèvement d’épave gratuit à Toulouse et 100 km. Véhicules HS, accidentés, brûlés, inondés. Certificat de destruction. Devis par téléphone ou via /contact. Intervention rapide (1–2 h).";

// Schéma principal : Service d’épaviste (avec le business en provider)
const serviceJsonld = {
  '@context': 'https://schema.org',
  '@type': 'Service',
  name: "Épaviste — enlèvement d’épaves gratuit",
  areaServed: 'Toulouse et 100 km',
  serviceType: 'Vehicle scrapping & removal',
  provider: {
    '@type': 'AutomotiveBusiness',
    name: data.name,
    telephone: data.phoneCompact,
    email: data.email,
    address: {
      '@type': 'PostalAddress',
      streetAddress: data.address.street,
      postalCode: data.address.postalCode,
      addressLocality: data.address.city,
      addressRegion: data.address.region,
      addressCountry: 'FR'
    }
  },
  hasOfferCatalog: {
    '@type': 'OfferCatalog',
    name: 'Catalogue épaviste',
    itemListElement: [
      { '@type': 'Offer', name: "Enlèvement d’épave à domicile (gratuit)", price: 0, priceCurrency: 'EUR' },
      { '@type': 'Offer', name: 'Véhicules HS / accidentés / brûlés / inondés' },
      { '@type': 'Offer', name: 'Utilitaires & camping-cars (sur devis)' },
      { '@type': 'Offer', name: 'Moto / scooter' },
      { '@type': 'Offer', name: 'Poids lourds & machines agricoles (sur devis)' },
      { '@type': 'Offer', name: 'Destruction avec certificat (centre VHU agréé)' }
    ]
  }
};

// FAQ SEO dédiée
const faqJsonld = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    { '@type': 'Question', name: "L’enlèvement est-il vraiment gratuit ?", acceptedAnswer: { '@type': 'Answer', text: "Oui, dans un rayon de 100 km autour de Toulouse. Au-delà, un devis clair est proposé avant toute intervention." } },
    { '@type': 'Question', name: "Quels documents sont nécessaires ?", acceptedAnswer: { '@type': 'Answer', text: "Carte grise si disponible, pièce d’identité et formulaire Cerfa adapté. En cas de perte de carte grise, des alternatives existent : nous vous guidons." } },
    { '@type': 'Question', name: "Quand vais-je recevoir le certificat de destruction ?", acceptedAnswer: { '@type': 'Answer', text: "Après traitement dans un centre VHU agréé ; le document officiel est généralement émis sous environ un mois." } },
    { '@type': 'Question', name: "Quel est le délai d’intervention ?", acceptedAnswer: { '@type': 'Answer', text: "En général sous 1–2 heures selon disponibilité et trafic, pour les demandes autour de Toulouse." } }
  ]
};
---

<Layout title={title} description={description} jsonld={serviceJsonld} lang="fr" canonical="/epaviste/">
  <MobileCTA phoneCompact={data.phoneCompact} />

  <!-- Fil d’Ariane -->
  <nav class="mx-auto max-w-6xl px-6 pt-6 text-sm text-gray-700">
    <a href="/" class="rounded-lg px-2 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Accueil</a>
    <span aria-hidden="true"> / </span>
    <a href="/services/" class="rounded-lg px-2 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Services</a>
    <span aria-hidden="true"> / </span>
    <span class="px-2 py-1 text-gray-500">Épaviste</span>
  </nav>

  <!-- Hero -->
  <section class="relative mx-auto max-w-6xl px-6 pb-4 pt-10">
    <div class="pointer-events-none absolute inset-x-0 top-0 -z-10 h-28 bg-gradient-to-b from-emerald-100/60 to-transparent opacity-70"></div>
    <header class="reveal" style="--delay:0ms">
      <h1 class="text-3xl font-bold tracking-tight md:text-4xl">Épaviste à Toulouse — enlèvement d’épaves gratuit</h1>
      <p class="mt-3 max-w-3xl text-zinc-600">
        Prise en charge <strong>gratuite</strong> dans un rayon de <strong>100 km</strong> autour de Toulouse, 100% conforme (centre <strong>VHU agréé</strong>) avec
        <strong>certificat de destruction</strong>. Intervention rapide <em>(1–2 h selon disponibilité)</em>, <strong>zéro frais cachés</strong>.
      </p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href={`tel:${data.phoneCompact}`} class="inline-flex items-center gap-2 rounded-2xl bg-emerald-600 px-5 py-2.5 font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md">
          Appeler {data.phone}
        </a>
        <a href="/contact" class="inline-flex items-center gap-2 rounded-2xl bg-white px-5 py-2.5 font-semibold text-gray-900 ring-1 ring-gray-300 transition hover:-translate-y-0.5 hover:bg-gray-50">
          Demander un enlèvement via /contact
        </a>
        <a href="/zones/" class="inline-flex items-center gap-2 rounded-2xl bg-white px-5 py-2.5 font-semibold text-gray-900 ring-1 ring-gray-300 transition hover:-translate-y-0.5 hover:bg-gray-50">
          Voir nos zones d’intervention
        </a>
      </div>
    </header>
  </section>

  <!-- Atouts -->
  <section class="reveal mx-auto max-w-6xl px-6 py-12" style="--delay:120ms">
    <div class="grid gap-6 md:grid-cols-3">
      {[
        {title:'Gratuit (100 km)',desc:'Aucun frais surprise dans le rayon de 100 km autour de Toulouse.'},
        {title:'Traçabilité & conformité',desc:'Dépollution et destruction en centre VHU agréé, certificat officiel.'},
        {title:'Rapide',desc:'Prise en charge en 1–2 h selon disponibilité et trafic.'}
      ].map((f) => (
        <article class="group relative overflow-hidden rounded-2xl bg-white p-6 ring-1 ring-gray-200 transition hover:shadow-md">
          <div class="pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-300 group-hover:opacity-100" style="background: radial-gradient(320px circle at var(--x,50%) var(--y,50%), rgba(16,185,129,.08), transparent 40%);"></div>
          <h2 class="font-semibold">{f.title}</h2>
          <p class="mt-2 text-sm text-zinc-600">{f.desc}</p>
        </article>
      ))}
    </div>
  </section>

  <!-- Véhicules acceptés -->
  <section class="reveal mx-auto max-w-6xl px-6 py-8" style="--delay:160ms">
    <div class="rounded-2xl bg-white p-6 ring-1 ring-gray-200 shadow-sm">
      <h2 class="text-2xl font-bold tracking-tight md:text-3xl">Véhicules acceptés</h2>
      <ul class="mt-5 grid gap-3 sm:grid-cols-2 lg:grid-cols-3 text-sm text-zinc-700">
        <li class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-200">Voitures HS / accidentées</li>
        <li class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-200">Brûlées / inondées</li>
        <li class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-200">Utilitaires & camping-cars (sur devis)</li>
        <li class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-200">Moto / scooter</li>
        <li class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-200">Poids lourds & agricoles (sur devis)</li>
        <li class="rounded-xl bg-emerald-50 px-4 py-3 ring-1 ring-emerald-200">Épaves sans roues / hors d’usage</li>
      </ul>
      <p class="mt-4 text-sm text-zinc-600">Accès sous-sol, cour intérieure ou voie publique : on s’adapte (matériel adapté, sur devis si besoin).</p>
    </div>
  </section>

  <!-- Documents nécessaires -->
  <section class="reveal mx-auto max-w-6xl px-6 py-8" style="--delay:180ms">
    <div class="rounded-2xl bg-white p-6 ring-1 ring-gray-200 shadow-sm">
      <h2 class="text-2xl font-bold tracking-tight md:text-3xl">Documents à prévoir</h2>
      <ul class="mt-4 list-disc space-y-2 pl-6 text-sm text-zinc-700">
        <li>Carte grise (si disponible) et pièce d’identité.</li>
        <li>Formulaire Cerfa approprié pour la cession/destruction (nous vous guidons).</li>
        <li>Clés du véhicule si possible ; sinon, enlèvement possible selon accès.</li>
      </ul>
      <p class="mt-3 text-sm text-zinc-600">Sans carte grise : déclaration de perte, certificat notarié ou autres justificatifs — on vous explique la bonne procédure.</p>
    </div>
  </section>

  <!-- Comment ça se passe ? -->
  <section class="reveal mx-auto max-w-6xl px-6 pb-6" style="--delay:200ms">
    <div class="rounded-2xl bg-white p-6 ring-1 ring-gray-200">
      <h2 class="text-2xl font-bold tracking-tight md:text-3xl">Comment ça se passe ?</h2>
      <ol class="mt-4 list-decimal space-y-2 pl-6 text-sm text-zinc-700">
        <li>Contact : téléphone ou <a href="/contact" class="underline">/contact</a> avec adresse et type de véhicule.</li>
        <li>Enlèvement : nos équipes récupèrent l’épave à domicile ou sur site.</li>
        <li>Traitement : dépollution et destruction en centre VHU agréé.</li>
        <li>Certificat : vous recevez le <strong>certificat de destruction</strong> (délai moyen ~1 mois).</li>
      </ol>
    </div>
  </section>

  <!-- CTA -->
  <section class="reveal mx-auto max-w-6xl px-6 pb-2" style="--delay:220ms">
    <div class="flex flex-wrap gap-3">
      <a href={`tel:${data.phoneCompact}`} class="inline-flex items-center gap-2 rounded-2xl bg-emerald-600 px-5 py-2.5 font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md">
        Appeler {data.phone}
      </a>
      <a href="/contact" class="inline-flex items-center gap-2 rounded-2xl bg-white px-5 py-2.5 font-semibold text-gray-900 ring-1 ring-gray-300 transition hover:-translate-y-0.5 hover:bg-gray-50">
        Demander un enlèvement via /contact
      </a>
    </div>
  </section>

  <Contact data={data} />

  <!-- JSON-LD FAQ -->
  <script type="application/ld+json">{JSON.stringify(faqJsonld)}</script>
</Layout>

<style is:global>
  .reveal { opacity: 0; transform: translateY(8px); transition: opacity .45s ease, transform .45s ease; transition-delay: var(--delay, 0ms); }
  .reveal.is-inview { opacity: 1; transform: translateY(0); }
  @media (prefers-reduced-motion: reduce) { .reveal { opacity: 1; transform: none; transition: none; } }
</style>

<script>
  const io = new IntersectionObserver((entries) => {
    entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('is-inview'); io.unobserve(e.target); } });
  }, { threshold: 0.18 });
  document.querySelectorAll('.reveal').forEach(el => io.observe(el));
</script>
