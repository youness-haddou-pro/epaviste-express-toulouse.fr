---
import Layout from '../layouts/Layout.astro';
import MobileCTA from '../components/MobileCTA.astro';
import { data } from '../data/siteData';

const title = `Certificat de destruction VHU – Délivrance & délais | ${data.name}`;
const description = "Tout savoir sur le certificat de destruction : documents nécessaires, étapes, délais (~1 mois), et comment le recevoir après l’enlèvement de votre épave.";

const howtoJsonld = {
  '@context': 'https://schema.org',
  '@type': 'HowTo',
  name: 'Obtenir un certificat de destruction VHU',
  totalTime: 'P1M',
  supply: [
    { '@type': 'HowToSupply', name: 'Carte grise (si disponible)' },
    { '@type': 'HowToSupply', name: 'Pièce d’identité' },
    { '@type': 'HowToSupply', name: 'Formulaire Cerfa (cession pour destruction)' }
  ],
  step: [
    { '@type': 'HowToStep', name: 'Prise de contact', text: 'Appelez-nous ou passez par le formulaire de contact pour planifier l’enlèvement.' },
    { '@type': 'HowToStep', name: 'Enlèvement', text: 'Nous récupérons le véhicule (gratuit jusqu’à 100 km autour de Toulouse) et transmettons au centre VHU.' },
    { '@type': 'HowToStep', name: 'Traitement', text: 'Dépollution et traitement réglementaire en centre agréé avec traçabilité.' },
    { '@type': 'HowToStep', name: 'Émission du certificat', text: 'Le centre VHU émet le certificat de destruction. Le délai moyen est d’environ un mois.' }
  ]
};

const faqJsonld = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    {
      '@type': 'Question',
      name: "Combien de temps pour recevoir le certificat ?",
      acceptedAnswer: { '@type': 'Answer', text: "Le délai moyen est d’environ un mois après le traitement par le centre VHU. Nous vous tenons informé." }
    },
    {
      '@type': 'Question',
      name: "Et si je n’ai plus la carte grise ?",
      acceptedAnswer: { '@type': 'Answer', text: "Des solutions existent (déclaration de perte, justificatifs). Contactez-nous : nous vous guidons sur les documents alternatifs." }
    },
    {
      '@type': 'Question',
      name: "Le certificat met-il fin à l’assurance ?",
      acceptedAnswer: { '@type': 'Answer', text: "Oui, une fois le certificat obtenu, vous pouvez résilier l’assurance et signaler la destruction." }
    }
  ]
};

const docs = [
  { label: 'Carte grise', txt: 'Si disponible, barrée avec la mention « cédé pour destruction » et signée.' },
  { label: 'Pièce d’identité', txt: 'Titulaire (et co-titulaire le cas échéant).' },
  { label: 'Formulaire Cerfa', txt: 'Déclaration de cession pour destruction (nous pouvons vous assister).' },
  { label: 'Clés / justificatifs', txt: 'Clés si présentes ; justificatifs en cas de perte des papiers.' },
];
---

<Layout title={title} description={description} lang="fr">
  <MobileCTA phoneCompact={data.phoneCompact} />

  <!-- Fil d’Ariane -->
  <nav class="mx-auto max-w-6xl px-6 pt-6 text-sm text-gray-700">
    <a href="/" class="rounded-lg px-2 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Accueil</a>
    <span aria-hidden="true"> / </span>
    <a href="/services/" class="rounded-lg px-2 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Services</a>
    <span aria-hidden="true"> / </span>
    <span class="px-2 py-1 text-gray-500">Certificat de destruction</span>
  </nav>

  <!-- Hero -->
  <section class="relative mx-auto max-w-6xl px-6 pb-4 pt-10">
    <div class="pointer-events-none absolute inset-x-0 top-0 -z-10 h-28 bg-gradient-to-b from-emerald-100/60 to-transparent opacity-70"></div>
    <header class="reveal" style="--delay:0ms">
      <h1 class="text-3xl font-bold tracking-tight md:text-4xl">Certificat de destruction</h1>
      <p class="mt-3 max-w-3xl text-zinc-600">
        Document officiel émis par un centre VHU agréé après traitement. Délai indicatif&nbsp;: <strong>~1 mois</strong>.
      </p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href={`tel:${data.phoneCompact}`} class="inline-flex items-center gap-2 rounded-2xl bg-emerald-600 px-5 py-2.5 font-semibold text-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md">
          Appeler {data.phone}
        </a>
        <a href="/depollution/" class="inline-flex items-center gap-2 rounded-2xl bg-white px-5 py-2.5 font-semibold text-gray-900 ring-1 ring-gray-300 transition hover:-translate-y-0.5 hover:bg-gray-50">
          Voir la dépollution
        </a>
      </div>
    </header>
  </section>

  <!-- Documents nécessaires -->
  <section class="reveal mx-auto max-w-6xl px-6 py-10" style="--delay:120ms">
    <h2 class="text-2xl font-bold tracking-tight md:text-3xl">Documents à prévoir</h2>
    <div class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
      {docs.map((d, i) => (
        <article
          class="group relative overflow-hidden rounded-2xl bg-white p-5 ring-1 ring-gray-200 transition hover:shadow-xl"
          style={`--delay:${i*80}ms`}
        >
          <div class="pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-300 group-hover:opacity-100"
               style="background: radial-gradient(300px circle at var(--x,50%) var(--y,50%), rgba(16,185,129,.08), transparent 40%);"></div>
          <h3 class="font-semibold">{d.label}</h3>
          <p class="mt-2 text-sm text-zinc-600">{d.txt}</p>
        </article>
      ))}
    </div>
    <p class="mt-3 text-xs text-zinc-500">Sans carte grise : des alternatives existent. Contactez-nous, on vous accompagne.</p>
  </section>

  <!-- Timeline d’obtention -->
  <section class="reveal mx-auto max-w-6xl px-6 pb-10" style="--delay:180ms">
    <h2 class="text-2xl font-bold tracking-tight md:text-3xl">Comment ça se passe ?</h2>
    <ol class="mt-6 space-y-4">
      <li class="rounded-2xl bg-white p-4 ring-1 ring-gray-200"><strong>1. Enlèvement gratuit</strong> à Toulouse et 100 km autour.</li>
      <li class="rounded-2xl bg-white p-4 ring-1 ring-gray-200"><strong>2. Dépollution</strong> et traitement en centre VHU agréé (traçabilité).</li>
      <li class="rounded-2xl bg-white p-4 ring-1 ring-gray-200"><strong>3. Émission du certificat</strong> par le centre (~1 mois).</li>
      <li class="rounded-2xl bg-white p-4 ring-1 ring-gray-200"><strong>4. Résiliation assurance</strong> et clôture administrative de votre côté.</li>
    </ol>
    <div class="mt-6 flex flex-wrap gap-2 text-sm">
      <a href="/contact/" class="rounded-lg px-3 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Demander un enlèvement</a>
      <a href="/zones/" class="rounded-lg px-3 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Zones d’intervention</a>
      <a href="/services/" class="rounded-lg px-3 py-1 ring-1 ring-gray-300 transition hover:bg-gray-100">Voir nos services</a>
    </div>
  </section>

  <!-- JSON-LD HowTo + FAQ -->
  <script type="application/ld+json">{JSON.stringify(howtoJsonld)}</script>
  <script type="application/ld+json">{JSON.stringify(faqJsonld)}</script>

  <style is:global>
    .reveal { opacity:0; transform:translateY(8px); transition:opacity .45s ease, transform .45s ease; transition-delay:var(--delay,0ms); }
    .reveal.is-inview { opacity:1; transform:translateY(0); }
    @media (prefers-reduced-motion: reduce){ .reveal{ opacity:1; transform:none; transition:none; } }
  </style>

  <script>
    const io = new IntersectionObserver((es)=>{es.forEach(e=>{if(e.isIntersecting){e.target.classList.add('is-inview');io.unobserve(e.target);}})},{threshold:.18});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
    document.querySelectorAll('article.group').forEach((el)=>{
      el.addEventListener('mousemove', (e)=>{const r=el.getBoundingClientRect(); el.style.setProperty('--x',((e.clientX-r.left)/r.width)*100+'%'); el.style.setProperty('--y',((e.clientY-r.top)/r.height)*100+'%');});
      el.addEventListener('mouseleave', ()=>{el.style.removeProperty('--x'); el.style.removeProperty('--y');});
    });
  </script>
</Layout>
